# 実装計画書: [機能名]

> **Note**
> このドキュメントは、VibeCodingプロセスにおける「実装計画」の中心となる**マスタープロンプト**です。
> 詳細設計に基づき、実装可能なレベルまでタスクを具体化し、AIアシスタントが一連の作業を自律的に実行するためのインプットとなります。
>
> **この計画書が完成したら、LLMとのコンテキストを一度クリアし、新しい会話でこの計画書全体を読み込ませてから実装を開始してください。**

---

## 1. 概要

-   **機能名**: [実装する機能の名称を記述] (例: ユーザー認証API)
-   **関連ドキュメント**:
    -   全体設計: `[全体設計ドキュメントへのリンク]`
    -   詳細設計: `[詳細設計ドキュメントへのリンク]`
-   **担当者**: [担当者名]
-   **完了目標日**: YYYY-MM-DD

---

## 2. 全体方針・共通要件

> このセクションでは、これから実行する全てのタスクに共通する、横断的なルールや要件を定義します。AIアシスタントは、個別のタスクを実行する際に、必ずこの共通要件を遵守してください。

-   **コーディング規約**:
    -   全てのコードは、プロジェクトで定義された`ruff`と`mypy`の静的解析をパスする必要があります。
    -   変数名や関数名は、プロジェクト全体の命名規則に従い、意図が明確に伝わるように命名してください。
    -   マジックナンバーは避け、定数として定義してください。
-   **テスト方針**:
    -   全ての新しいビジネスロジックには、対応するユニットテストが必要です。
    -   テストは`pytest`を使用して記述し、正常系と異常系の両方のケースをカバーしてください。
    -   `src`ディレクトリの構造をミラーリングする形で、`tests`ディレクトリにテストコードを配置してください。
-   **エラーハンドリング**:
    -   予期せぬエラーは適切にハンドリングし、必要に応じてカスタム例外を発生させてください。
-   **その他**:
    -   [その他、全体に関わる要件があれば記述]

---

## 3. 実装タスク一覧

> このセクションでは、実装作業を具体的なタスクに分割します。原則として、一度に一つのタスクを指示し、完了を確認してから次のタスクに進みます。

-   [ ] **Task 1: [最初のタスク名]** (例: ユーザーモデルの定義)
    -   **目的**: [このタスクで達成すること] (例: `pydantic`を使用して`User`モデルを作成する)
    -   **実装ファイル**: `src/domain/models/user.py`
    -   **完了条件**:
        -   `id`, `username`, `hashed_password`フィールドを持つ`User`クラスが定義されている。
        -   `username`には適切なバリデーションが設定されている。
    -   **テスト要件**: (このタスクでテストを実装する場合)
        -   モデルの正常なインスタンス化をテストする。
        -   バリデーションが失敗するケースをテストする。

-   [ ] **Task 2: [2番目のタスク名]** (例: ユーザー作成サービスの追加)
    -   **目的**: [このタスクで達成すること] (例: 新規ユーザーを作成するビジネスロジックを実装する)
    -   **実装ファイル**: `src/core/services/user_service.py`
    -   **依存関係**: `Task 1`で作成した`User`モデル
    -   **完了条件**:
        -   `create_user`関数が定義され、平文パスワードをハッシュ化する。
        -   ユーザー名が重複している場合に例外を発生させる。
    -   **テスト要件**:
        -   ユーザーが正常に作成できることをテストする。
        -   パスワードがハッシュ化されていることをテストする。
        -   ユーザー名が重複した場合に、指定の例外が発生することをテストする。

-   [ ] **Task 3: ...**

---

## 4. 補足情報 (既存コードなど)

> 実装に着手する前にAIアシスタントが知っておくべき、既存のコードや特に注意してほしい点をここに記述します。

-   **ロギングモジュールの使い方**:
    ```python
    # shared/logging.py
    from shared.logging import get_logger

    logger = get_logger(__name__)
    logger.info("このようにロガーを使用してください")
    ```
